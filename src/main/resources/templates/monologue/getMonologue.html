<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout" xmlns="http://www.w3.org/1999/html">
  
<head>
<meta charset="UTF-8">
<title>GET MONOLOGUE</title>

    <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Stylish&display=swap" rel="stylesheet">

    
       <link rel="stylesheet" href='../../css/main/menu.css' />
    <script src="../../js/main/main.js"></script>


    <style type="text/css">
        body{
            background-image: url("https://source.unsplash.com/user/senbro/likes");
            background-repeat:no-repeat;
            background-size: cover;
            font-family: 'Stylish', sans-serif;
        }

        h1{
            text-align: center;
            margin-top: 7%;
            font-size: 80px;
            color: white;
            text-shadow: 1px 1px black;
        }

        .container{
            display: grid;
            grid-template-areas:
                    "question question"
                    "answer answer"
                    "button1 button2";
            gap: 50px;
            align-items: stretch;
            margin-top: 5%;
        }

        #questionText{
            grid-area: question;
            color: white;
            font-size: 50px;
            text-decoration: underline;
            text-decoration-style: solid;
            text-decoration-thickness: 1px;
        }

        #monologueText{
            grid-area: answer;
            color: white;
            font-size: 40px;
            border: 1px solid white;
            border-radius: 3px;
            height: 200px;
        }

        #modifyMonologue{
            grid-area: button1;
            color: white;
            font-size: 25px;
            display: block;
            border: none;
            width: 30%;
            background-color: transparent;
            margin-left: 75%;
        }

        #reportModal{
            grid-area: button2;
            color: white;
            font-size: 25px;
            display: block;
            border: none;
            width: 30%;
            background-color: transparent;
            margin-left: 5%;
        }

        .translateBtns{
            margin-left: 46%;
        }

        .translateBtns span{
            color: white;
        }

        #source, #target{
            background-color: rgba(255, 255, 255, 0.5);
            border: none;
        }
    </style>




</head>

<script type="text/javascript">
$(function(){
	   var user = [[${user}]];
	   if(user=='0'){
		   $("#reportModal").remove();
	   }else(user=='1'){
		   $("#modifyMonologue").remove();
	   }
   });
   </script>


<script>
 $(function(){
  $(".translate").on("click",function(){
   let text = {text : $("#monologueText").text(),
    source:$("#source option:selected").val(),
    target:$("#target option:selected").val(),
    question:$("#questionText").text()};
   $.ajax({
    url : "/restMonologue/translateMonologue",
    type : "POST",
    data :JSON.stringify(text),
    contentType: "application/json",
    success: function (response){
     if($("#monologueText").attr('name') == $("#target option:selected").val()){
      alert("이미 번역되었습니다.");
     }else{
      $(".translatedMonologue").remove();
      $("#monologueText").after("<div class='translatedMonologue'>"+JSON.parse(response).message.result.translatedText+"</div> ");
      $("#monologueText").attr('name',$("#target option:selected").val());
     }

    }
   });
   $.ajax({
    url : "/restMonologue/translateQuestion",
    type : "POST",
    data :JSON.stringify(text),
    contentType: "application/json",
    success: function (response){
     if($("#questionText").attr('name') == $("#target option:selected").val()){
      alert("이미 번역되었습니다.");
     }else{
      $(".translatedQuestion").remove();
      $("#questionText").after("<div class='translatedQuestion'>"+JSON.parse(response).message.result.translatedText+"</div> ");
      $("#questionText").attr('name',$("#target option:selected").val());
     }

    }
   });

  })
 })

</script>
 <script>
        $(function(){
            $("#reportModal").on("click",function(){
                $("#eventModal").modal("show");
            })

            $("#send").on("click",function(e){

                if($("input:checkbox[name='reason']:checked").length > 1){
                    alert("신고사유는 한가지만 선택 가능합니다.")
                }else{
                    let text = {
                       reportText : $("#textArea").val(),
                        reportId : new Number($("#reportId").val()),
                        reportReasonId : new Number($("input:checkbox[name='reason']:checked").val()),
                        monologueId : $("#monologueId").val()
                    };
                    $.ajax({
                        url : "/restMonologue/monologueReport",
                        type : "POST",
                        data :JSON.stringify(text),
                        contentType: "application/json",
                        success: function (response){
                            alert(response);
                        }
                    });
                }

            })
    
        });
    
    
    
   </script>

   
   
   
<body>

<h1>모노로그 상세보기</h1>


<!-- <input type="text" name="questionId" th:value="${monologue.questionId}"/> -->


<form action="updateMonologue" method="get">
<input type="hidden" th:value="${monologue.monologueId}" name="monologueId" id="monologueId"/>
<input type="hidden" th:value="${monologue.questionId}" name="questionId"/>
<input type="hidden" th:value="${monologue.userId}" name="userId"/>

    <div class="container">


        <span id="questionText" th:text="${monologue.questionText}"/>
        <h2 id="monologueText" th:text="${monologue.monologueText}"/>


        <input type="submit" id="modifyMonologue" value="&#128214; 수정~★">

    </div>

</form>


        <button type="button" id="reportModal">&#128680; 신고하기</button>

    
  

    <div class="translateBtns">
        <select id="source">
            <option value="ko">한국어</option>
            <option value="en">영어</option>
            <option value="ja">일본어</option>
            <option value="zh-CN">중국어-간체</option>
            <option value="zh-TW">중국어-번체</option>
        </select>
        <span>&#10145;</span>
        <select id="target">
            <option value="ko">한국어</option>
            <option value="en">영어</option>
            <option value="ja">일본어</option>
            <option value="zh-CN">중국어-간체</option>
            <option value="zh-TW">중국어-번체</option>
        </select>
        <img class="translate" src="../../images/icon/translateIcon.png" width="25px" height="25px" style="cursor: pointer">
    </div>


<div class="modal fade" tabindex="-1" role="dialog" id="eventModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row">신고사유
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                   <span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-12">
                        <label class="cdl-xs-12">사유 선택</label>
                        <div class="col-xs-4">
                             <label>●성적인 컨텐츠<input type="checkbox" name="reason" value="1"> </label> 
                      <label>●폭력적 또는 혐오스러운 컨텐츠<input type="checkbox" name="reason" value="2"></label>       
                      <label>●증오 또는 악의적인 컨텐츠<input type="checkbox" name="reason" value="3"></label>       
                      <label>●유해하거나 위험한 행위 <input type="checkbox" name="reason" value="4"></label>       
                      <label>●스팸 또는 오해의 소재가 있는 컨텐츠<input type="checkbox" name="reason" value="5"></label>       
                      <label>●권리침해 <input type="checkbox" name="reason" value="6"></label>       
                      <label>●기타 <input type="checkbox" name="reason" value="7"></label>
                        </div>
                        <textarea id="textArea" class="col-xs-8" rows="8" cols="100"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer modalBtnContainer-addEvent">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="send">OK</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->



<div class="modal hidden"></div>


<input type="checkbox" id="menuToggler" class="input-toggler" />
<label for="menuToggler" class="menu-toggler">
    <span class="menu-toggler__line"></span>
    <span class="menu-toggler__line"></span>
    <span class="menu-toggler__line"></span>
</label>
<aside class="sidebar">
    <ul class="menu">
        <li class="menu__item"><a class="menu__link" href="/user/login">Home</a></li>
        <li class="menu__item"><a class="menu__link" href="/user/getUser">Profile</a></li>
        <li class="menu__item"><a class="menu__link" href="/diary/getDiaryList">Diary</a></li>
        <li class="menu__item"><a class="menu__link" href="/calendar/mainCalendar">Calendar</a></li>
        <li class="menu__item"><a class="menu__link" href="/monologue/getMonologueList">Monologue</a></li>
        <li class="menu__item"><a class="menu__link" href="/user/logout">Logout</a></li>
    </ul>


</aside>


</body>
</html>
