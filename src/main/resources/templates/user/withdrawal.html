<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <title>회원탈퇴</title>
    
  
    
     <script>
        $(function(){
            $("#withdrawal").on("click",function(){
            	if($("#password").val()==$("#dbpassword").val()){
            	let password={
            			password : $("#password").val(),
            			userId : $("#userId").val()
            	};
            	 $.ajax({
                     url : "/restUser/withdrawal",
                     type : "get",
                     data :JSON.stringify(password),
                     contentType: "application/json",
                     success: function (response){
                         alert(response);
                     }
                 });
                    	 $("#eventModal").modal("show");
            	}else{
            		alert("입력하신 비밀번호가 일치하지 않습니다.")
            	}
               
            })
            
             $("#send").on("click",function(e){

                if($("input:checkbox[name='reason']:checked").length > 1){
                    alert("신고사유는 한가지만 선택 가능합니다.")
                }else{
                    let text = {
                    	withdrawalReasonText : $("#textArea").val(),
                        withdrawalId : new Number($("#withdrawalId").val()),
                        withdrawalReasonType : new Number($("input:checkbox[name='reason']:checked").val())
                    };
                    $.ajax({
                        url : "/restUser/withdrawalReason",
                        type : "POST",
                        data :JSON.stringify(text),
                        contentType: "application/json",
                        success: function (response){
                            alert(response);
                        }
                    });
                }

            })
    
        });
    
   </script>
    
    
</head>
<body>

<h1>회원탈퇴</h1>

<form action="withdrawal" method="post">
<input type="hidden" name="userId" th:value="${userId}" id="userId"/>
<input type="hidden" name="password" th:value="${user.password}" id="dbpassword"/>
비밀번호 : <input type="text" placeholder="password" name="password" id="password"/>


</form>
<input type="button" class="btn btn-primary" id="withdrawal" value="☆탈퇴☆">





<div class="modal fade" tabindex="-1" role="dialog" id="eventModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row">탈퇴사유
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                   <span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-12">
                        <label class="cdl-xs-12">사유 선택</label>
                        <div class="col-xs-4">
                          	<label>사용빈도가 낮아서 <input type="checkbox" name="reason" value="1"></br></label>
                      	    <label>디자인이 마음에 들지 않아서 <input type="checkbox" name="reason" value="2"></br></label>
				            <label> 필요한 기능이 없어서 <input type="checkbox" name="reason" value="3"></br></label>
                           	<label>기타<input type="checkbox" name="reason" value="4"></br></label>
                        </div>
                        <textarea id="textArea" class="col-xs-8" rows="8" cols="100"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer modalBtnContainer-addEvent">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="send">OK</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->



</body>

</html>